@model Core.Models.ApplicationUser

@{
    ViewData["Title"] = "Register";
    Layout = "~/Views/Shared/_HomePageLayout.cshtml";
}

<style>
    #captureFaceBtn {
        margin-bottom: 10px;
    }

    #capturedFaceImage {
        max-width: 100%;
        margin-top: 10px;
    }
    #verificationIntro {
        font-size: medium;
    }

    #camera-container {
        display: flex;
        justify-content: center; 
        align-items: center; 
        height: 100vh; 
        border-radius: 50%; 
        overflow: hidden; 
    }

    #camera {
        max-width: 100%; /* Make it responsive */
        max-height: 80%; /* Make it responsive */
    }
    #capture-button {
        margin-top: 10px;
    }
</style>

<!-- Page Content -->
<div class="content container pt-5">
    <div class="card mt-5 p-3">
        <div class="row">
            <div class="col-md-2 pt-3">
                <div class="row justify-content-center">
                    <div class="col-md-12" onclick="showPatientBoarding()">
                        <h5 class="pt-0 tickcheck01 visit_listner" style="color: #007bff;"><i class="fa fa-check-circle" style="font-size: 25px;"></i>Registration page</h5>
                        <h5 class="px-2 pt-0 tickcheck01 visit_listner" style="color: #007bff;">|</h5>
                        <h5 class="px-2 pt-0 tickcheck01 visit_listner" style="color:  #007bff;">|</h5>
                    </div>
                    <div class="col-md-12" onclick="hidepatientboardingPage()">
                        <h5 class="pt-0 tickcheck02 visit_listner" style="color: #4c5b64;"><i class="fa fa-check-circle" style="font-size: 25px;"></i>Face Verification Page</h5>
                        <h5 class="px-2 pt-0 tickcheck02 visit_listner" style="color: #007bff;"></h5>
                        <h5 class="px-2 pt-0 tickcheck02 visit_listner" style="color: #007bff;"></h5>
                    </div>
                </div>
            </div>
            <div class="col-md-10" id="patientboardingPage">
                <div class="card mb-0">
                    <div class="card-body">
                        <!-- Page Header -->
                        <div class="page-header text-center mb-4">
                            <h3 class="page-title">Staff Registration Details</h3>
                        </div>
                        <!-- /Page Header -->

                        <div class="row mb-3" id="registrationPage">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="firstName">First Name <span class="text-danger">*</span></label>
                                    <input class="form-control" id="firstName" type="text">
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="lastName">Last Name <span class="text-danger">*</span></label>
                                    <input class="form-control" id="lastName" type="text">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="phoneNumber">Phone Number <span class="text-danger">*</span></label>
                                    <input class="form-control" id="phoneNumber" type="number">
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="mobileNumber">Mobile Number (Optional)</label>
                                    <input class="form-control" id="mobileNumber" type="number">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="email">Email <span class="text-danger">*</span></label>
                                    <input class="form-control" id="email" type="email">
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="address">Address (Optional)</label>
                                    <input class="form-control" id="address" type="text">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="genderId">Gender <span class="text-danger">*</span></label>
                                    <select id="genderId" class="form-control" asp-items="@(new SelectList(ViewBag?.Gender, "Id", "Name"))"></select>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="religion">Religion (Optional)</label>
                                    <input id="religion" type="text" class="form-control">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="password">Password <span class="text-danger">*</span></label>
                                    <input class="form-control" id="password" type="password">
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="confirmpassword">Password Confirm <span class="text-danger">*</span></label>
                                    <input class="form-control" id="confirmpassword" type="password">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-sm-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="displayOnRota">
                                    <label class="form-check-label" for="displayOnRota">I agree to be in Rota</label>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="termsCondition" required>
                                    <label class="form-check-label" for="termsCondition">I agree to these <a href="#" data-toggle="modal" data-target="#myModal">Terms and Conditions</a>.</label>
                                </div>
                            </div>
                        </div>
                        <div class="row text-center mb-4 mt-2">
                            
                            <div class="col-10">
                            </div>
                            <div class="col-2">
                                <button type="submit" class="btn btn-primary" onclick="hidepatientboardingPage()">Next</button>
                            </div>
                        </div>

                        <div class="text-right">
                            
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-10" id="boardingMedicationFoodPage" style="display: none;">
                <div class="chat-window">
                    <div class="task-wrapper">
                        <div class="task-list-container">
                            <!-- Add a heading for Face Verification -->
                            <div class="text-center">
                                <h4>Face Verification</h4>
                            </div>
                            <div class="page-header">
                                <p id="verificationIntro">
                                    Welcome to the Face Verification Center. This view is dedicated to ensuring the security of your identity.
                                    Please provide the necessary details and complete the face verification process to access our services securely and efficiently. Thank you for helping us maintain a safe and reliable environment.
                                </p>
                            </div>

                            <!-- Camera Feed Section -->
                            <div class="row">
                                <div class="col-sm-4"></div>
                                <div class="col-sm-4 col-md-6 d-flex justify-content-center align-items-center" id="camera-container">
                                    <video id="camera" autoplay><!-- Camera view will be displayed here --></video>
                                </div>
                                <div class="col-sm-4"></div>
                            </div>

                            <!-- Capture Button Section -->
                            <div class="row mb-3">
                                <div class="col-sm-4"></div>
                                <div class="col-sm-4 col-md-6 d-flex justify-content-center align-items-center">
                                    <button id="capture-button" class="btn btn-primary">Capture</button>
                                </div>
                                <div class="col-sm-4"></div>
                            </div>

                            <!-- Captured Image Section -->
                            <div class="row">
                                <div class="col-sm-3"></div>
                                <div class="col-sm-6 col-md-6 d-flex justify-content-center align-items-center">
                                    <div id="snapShot" class="text-center">
                                        <img id="captured_image" alt="Captured Face" style="display: none;">
                                    </div>
                                </div>
                                <div class="col-sm-3"></div>
                            </div>

                            <!-- Buttons for Previous and Save Data -->
                            <div class="row text-center mb-4 mt-2">
                                <div class="col-2">
                                    <button type="submit" class="btn btn-primary" onclick="previousBoardingMedicationFoodPage()">Previous</button>
                                </div>
                                <div class="col-8"></div>
                                <div class="col-2">
                                    <button onclick="Registeration()" class="btn btn-primary">Save Data</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- /Page Content -->
<script>
    function ChangeColorToValid(selectedClass) {

        for (var i = 0; i < selectedClass.length; i++) {
            selectedClass[i].style.color = "#007bff";
        }
    }
    function ChangeColorToInValid(selectedClass) {

        for (var i = 0; i < selectedClass.length; i++) {
            selectedClass[i].style.color = "gray";
        }
    }
    function hidepatientboardingPage() {
        var registerPage = document.getElementsByClassName("tickcheck01");
        var faceVerificationPage = document.getElementsByClassName("tickcheck02");
        var lastName = $('#lastName').val();
        var firstName = $('#firstName').val();
        if (firstName != "" && lastName != "") {
            $('#patientboardingPage').hide();
            $('#boardingMedicationFoodPage').show();
            ChangeColorToValid(registerPage);
            ChangeColorToValid(faceVerificationPage);
        }
        else {
            errorAlert("Please fill the form properly");
        }
    }
    
    function showPatientBoarding() {
        var registerPage = document.getElementsByClassName("tickcheck01");
        var faceVerificationPage = document.getElementsByClassName("tickcheck02");
        $('#patientboardingPage').show();
        $('#boardingMedicationFoodPage').hide();
        ChangeColorToValid(registerPage);
        ChangeColorToInValid(faceVerificationPage);
    }
    function previousBoardingMedicationFoodPage() {
        var patientboardingPage = document.getElementsByClassName("tickcheck01");;
        var boardingMedicationFoodPage = document.getElementsByClassName("tickcheck02");
        $('#patientboardingPage').show();
        $('#boardingMedicationFoodPage').hide();
        ChangeColorToValid(patientboardingPage);
        ChangeColorToInValid(BoardingMedicationFoodPage);
    }
   


    var profilePix = "";
    $(document).ready(function () {
        debugger
        captureUserImage();
    });
    // $(document).ready(function () {
    //     debugger
    //     const video = document.getElementById('camera');
    //     const captureButton = document.getElementById('capture-button');
    //     const capturedImage = document.getElementById('captured-image');
    //     let stream;

    //     // Get user's media (camera) when the page loads
    //     navigator.mediaDevices.getUserMedia({ video: true })
    //         .then(function (mediaStream) {
    //             stream = mediaStream;
    //             video.srcObject = mediaStream;
    //         })
    //         .catch(function (error) {
    //             console.error('Error accessing the camera:', error);
    //         });

    //     // Capture an image from the camera
    //     captureButton.addEventListener('click', function () {
    //         debugger
    //         const canvas = document.createElement('canvas');
    //         canvas.width = video.videoWidth;
    //         canvas.height = video.videoHeight;
    //         const context = canvas.getContext('2d');
    //         context.drawImage(video, 0, 0, canvas.width, canvas.height);

    //         // Convert the captured image to a data URL
    //         const imageDataUrl = canvas.toDataURL('image/png');

    //         // Display the captured image
    //         capturedImage.src = imageDataUrl;
    //         capturedImage.style.display = 'block';
    //         profilePix = imageDataUrl;
    //     });

    //     // When the user closes the page, stop the camera stream
    //     window.addEventListener('beforeunload', function () {
    //         if (stream) {
    //             stream.getTracks().forEach(track => track.stop());
    //         }
    //     });
    // });
</script>
